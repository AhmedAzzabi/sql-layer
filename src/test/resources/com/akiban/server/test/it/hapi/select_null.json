{

"setup" : {
    "processors_default" : [ "scanrows" ],

    "schema" : "test",

    "tables" : [
        [ "p", 
            "id int not null primary key",
            "other int",
            "v varchar(32)",
            "index(other)",
            "index(v)"],
        [ "c",
            "id int not null primary key",
            "pid int",
            "y year",
            "index(y)",
            "index(pid)",
            "grouping foreign key (pid) references p(id)"]
    ],

    "write_rows" : {
        "p" : [
            [1, null, "bob"],
            [2, 20, "twenty"],
            [3, 30, null]
        ],

        "c" : [
            [1, 1, "2011"],
            [2, 2, null],
            [3, null, "1986"]
        ]
    }
},

"tests" : {
    "select_all_p" : {
        "get" : "test:p:id>0",
        "expect result" :
        {
            "@p" :
            [
                {
                    "id" : 1,
                    "other" : null,
                    "v" : "bob",
                    "@c" :
                    [
                        {
                            "id" : 1,
                            "pid" : 1,
                            "y" : "2011"
                        }
                    ]
                },
                {
                    "id" : 2,
                    "other" : 20,
                    "v" : "twenty",
                    "@c" :
                    [
                        {
                            "id" : 2,
                            "pid" : 2,
                            "y" : null
                        }
                    ]
                },
                {
                    "id" : 3,
                    "other" : 30,
                    "v" : null,
                    "@c": []
                }
            ]
        }
    },

    "select_all_c" : {
        "get" : "test:c:id>0",
        "expect result" :
        {
            "@c" :
            [
                {
                    "id" : 1,
                    "pid" : 1,
                    "y" : "2011"
                },
                {
                    "id" : 2,
                    "pid" : 2,
                    "y" : null
                },
                {
                    "id" : 3,
                    "pid" : null,
                    "y" : "1986"

                }
            ]
        }
    },

    "select_orphan_c" : {
        "get" : "test:c:pid=NULL",
        "expect result" :
        {
            "@c" :
            [
                {
                    "id" : 3,
                    "pid" : null,
                    "y" : "1986"

                }
            ]
        }
    },

    "select_null_p_other" : {
        "get" : "test:p:other=NULL",
        "expect result" :
        {
            "@p" :
            [
                {
                    "id" : 1,
                    "other" : null,
                    "v" : "bob",
                    "@c" :
                    [
                        {
                            "id" : 1,
                            "pid" : 1,
                            "y" : "2011"
                        }
                    ]
                }
            ]
        }
    },

    "select_null_p_v" : {
        "get" : "test:p:v=NULL",
        "expect result" :
        {
            "@p" :
            [
                {
                    "id" : 3,
                    "other" : 30,
                    "v" : null,
                    "@c": []
                }
            ]
        }
    }
}

}
