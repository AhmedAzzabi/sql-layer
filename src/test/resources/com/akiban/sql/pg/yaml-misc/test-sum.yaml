# Test the SUM aggregate function
---
- Include: all-types-schema.yaml

# Test sum with no rows => null
---
- Statement: SELECT sum(bigint_field), sum(decimal_field), sum(double_field),
    sum(float_field), sum(integer_field), sum(numeric_field),
    sum(smallint_field) FROM all_types
- output: [[null, null, null, null, null, null, null]]

# Not working: sum(real)
# ---
# - Statement: SELECT sum(real) FROM all_types
# - output: [[null]]

# Test insert and sum

---
- Statement: INSERT INTO all_types
    (bigint_field, decimal_field, double_field, float_field, integer_field,
     numeric_field, smallint_field)
    VALUES
    (1, 2.0, 3.0, 4.0, 5, 6.0, 7)
---
- Statement: SELECT bigint_field, decimal_field, double_field, float_field,
     integer_field, numeric_field, smallint_field FROM all_types
- output: [[1, 2.0, 3.0, 4.0, 5, 6.0, 7]]

---
- Statement: SELECT sum(bigint_field), sum(decimal_field), sum(double_field),
    sum(float_field), sum(integer_field), sum(numeric_field),
    sum(smallint_field) FROM all_types
- output: [[1, 2.0, 3.0, 4.0, 5, 6.0, 7]]

# Insert a row of nulls
---
- Statement: INSERT INTO all_types
    (bigint_field, decimal_field, double_field, float_field, integer_field,
     numeric_field, smallint_field)
    VALUES
    (null, null, null, null, null, null, null)

---
- Statement: INSERT INTO all_types
    (bigint_field, decimal_field, double_field, float_field, integer_field,
     numeric_field, smallint_field)
    VALUES
    (1, 2.0, 3.0, 4.0, 5, 6.0, 7)
---
- Statement: SELECT sum(bigint_field), sum(decimal_field), sum(double_field),
    sum(float_field), sum(integer_field), sum(numeric_field),
    sum(smallint_field) FROM all_types
- output: [[2, 4.0, 6.0, 8.0, 10, 12.0, 14]]

# Negative values not working for double and float
---
- Statement: INSERT INTO all_types
    (bigint_field, decimal_field, integer_field,
     numeric_field, smallint_field)
    VALUES
    (-4, -8.0, -20, -24.0, -28)
---
- Statement: SELECT sum(bigint_field), sum(decimal_field), sum(integer_field),
    sum(numeric_field), sum(smallint_field) FROM all_types
- output: [[-2, -4.0, -10, -12.0, -14]]

---
- Statement: INSERT INTO all_types
    (bigint_field, decimal_field, integer_field, numeric_field, smallint_field)
    VALUES
    (2, 4.0, 10, 12.0, 14)
---
- Statement: SELECT sum(bigint_field), sum(decimal_field), sum(integer_field),
    sum(numeric_field), sum(smallint_field) FROM all_types
- output: [[0, 0.0, 0, 0.0, 0]]

---
- Statement: DELETE from all_types

# Test overflow and underflow

---
- Statement: INSERT INTO all_types (bigint_field) VALUES (9223372036854775807)
---
- Statement: SELECT sum(bigint_field) FROM all_types
- output: [[9223372036854775807]]
---
- Statement: INSERT INTO all_types (bigint_field) VALUES (1)
---
- Statement: SELECT sum(bigint_field) FROM all_types
- output: [[-9223372036854775808]]
---
- Statement: INSERT INTO all_types (bigint_field) VALUES (-1)
---
- Statement: SELECT sum(bigint_field) FROM all_types
- output: [[9223372036854775807]]

...
