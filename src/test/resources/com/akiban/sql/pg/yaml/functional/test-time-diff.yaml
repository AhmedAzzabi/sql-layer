# Test the TIMEDIFF() function 
# bug 921095 negative time value not supported
# status: new
#
# bug: DECIMAL (floating point) not convertible to time)
#
# bug: 921124 (not valid / opinion)
---
- Include: all-types-schema.yaml
---
- Statement: INSERT INTO all_types (bigint_field, time_field, timestamp_field, varchar_field) VALUES (1, '01:05:06', '2012-01-01 12:31:00', '2012-03-04 18:22:15')
---
- Statement: select TIMEDIFF(time_field, '00:00:01') from all_types;
- output_types: [TIME]
---
- Statement: select TIMEDIFF('12:31:15', '00:00:01') from all_types;
- output: [['12:31:14']]
---
- Statement: select TIMEDIFF('2010-01-01 01:00:00', '2010-01-01 00:00:01') from all_types;
- output: [['00:59:59']]
--- #Constants & params
- Statement: select TIMEDIFF(time_field, ?) from all_types;
- params: [['00:00:01']]
- output: [['01:05:05']]
--- #bug 903498
# NOTE: Not valid. Two arguments of TIMEDIFF must have the same type
# Or one is a DATE/TIME/DATETIME/TIMESTAMP and the other is a VARCHAR that is
# convertible to the other's type
## BUG 921117: TIMEDIFF of mis-matched args return NULL
- Message: 'The following test is wrong with newtypes! see bug 1064446'
---
- Statement: select TIMEDIFF(timestamp_field, ?) from all_types;
- params: [['00:00:01']]
- output: [[null]]
---
- Statement: select TIMEDIFF(varchar_field, ?) from all_types;
- params: [['2012-03-04 00:00:01']]
- output: [['18:22:14']]
--- #params & fields in select
- Statement: select TIMEDIFF(time_field, ?) from all_types;
- params: [['00:00:01']]
- output: [['01:05:05']]
--- 
- Statement: select 1 from all_types WHERE TIMEDIFF(time_field, ?) != '01:01:23';
- params: [['00:00:01']]
- output: [['1']]
--- #fields in select
- Statement: select TIMEDIFF(time_field, '00:00:01') from all_types;
- output: [['01:05:05']]
--- #bug 921117: return NULL
- Statement: select TIMEDIFF(timestamp_field, '00:00:01') from all_types;
- output: [[null]]
---
- Statement: select TIMEDIFF(varchar_field, '00:00:01') from all_types;
- output: [[null]]
---  #fields in where  # bug 921088
- Statement: select 1 from all_types where TIMEDIFF(time_field, '00:00:01') < '12:31:31';
- output: [['1']]
--- 
- Statement: select 1 from all_types WHERE TIMEDIFF(varchar_field, '2006-11-07 00:00:01') > '00:01:01';
- output: [['1']]
---
- Statement: select TIMEDIFF('12:34:55', '00:00:01') from all_types;
- output: [['12:34:54']]
#--- #bug 921095
#- Statement: select TIMEDIFF('00:00:01', '12:34:55') from all_types;
#- output: [['-12:34:54']]
---
- Statement: select TIMEDIFF('12:34:55', '07:00:00') from all_types;
- output: [['05:34:55']]
---
- Statement: select TIMEDIFF('12:34:55', '00:04:00') from all_types;
- output: [['12:30:55']]
#--- #bug 921095
#- Statement: select TIMEDIFF('12:34:55', '23:59:59') from all_types;
#- output: [['-11:25:04']]
#--- # bug 921117
#- Statement: select TIMEDIFF('12:34:55', '2012-04-05 01:59:59') from all_types;
#- output: [['null']]
--- # bug 921117
- Statement: select TIMEDIFF('2012-04-05 13:59:59', '03:34:55') from all_types;
- output: [[null]]
---
- Statement: select TIMEDIFF('12:34:55', '00:04:00') from all_types;
- output: [['12:30:55']]
---
- Statement: select TIMEDIFF('12:34:55', null) from all_types;
- output: [[null]]
---
- Statement: select TIMEDIFF(null, '12:34:55') from all_types;
- output: [[null]]
---
- Statement: select TIMEDIFF(null, null) from all_types;
- output: [[null]]
---
- Statement: select TIMEDIFF(5, 2) from all_types;
- output: [['00:00:03']]
---
- Statement: select TIMEDIFF('12:34:55', 17) from all_types;
- output: [['12:34:38']]
#--- #921127
#- Statement: select TIMEDIFF('12:34:55', -17) from all_types;
#- output: [['12:35:12']]
#--- Bug : DECIMAL (DOUBLE/FLOAT) not convertible to TIME
#- Statement: select TIMEDIFF('12:34:55', 17.495) from all_types;
#- output: [['12:34:37.505000']] #fractional seconds -> not supported yet
#- output: [['12:34:37']]
#--- # bug 921124 -> invalid.
#- Statement: select TIMEDIFF('12:34:55', 'TIME TO GO') from all_types;
#- output: [['12:34:55']]
...