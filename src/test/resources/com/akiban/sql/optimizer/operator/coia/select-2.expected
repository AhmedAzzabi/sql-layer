PhysicalSelect[name:varchar(32)[VARCHAR], order_date:date[DATE], city:varchar(100)[VARCHAR]]
  project(Field(1), Field(8), Field(5))
    Product_NestedLoops(flatten(test.customers, test.addresses) x flatten(test.customers, test.orders))
      Flatten_HKeyOrdered(test.customers INNER test.addresses)
        AncestorLookup_Default(Index(test.addresses.state[IndexColumn(state)]) -> [test.customers, test.addresses])
          IndexScan_Default(Index(test.addresses.state[IndexColumn(state)]) (>=UnboundExpressions[Literal(MA)],<=UnboundExpressions[Literal(MA)]))
      Filter_Default([flatten(test.customers, test.orders)])
        Flatten_HKeyOrdered(test.customers INNER test.orders)
          BranchLookup_Nested(_akiban_customers test.customers -> test.orders)