SelectQuery@29d65b
  ResultSet@b8176d[order_date, name]
    MapJoin@552a2b()
      Flatten@143a083(customers INNER orders)
        Select@df0256[orders.order_date > Cast(2011-01-01 AS DATE NOT NULL)]
          AncestorLookup@1127b52(items -> [customers, orders])
            IndexScan@5e7020(Index(user.items.sku[IndexColumn(sku)]), NONE, =1234)
            TableSource@1991de1(customers - TableGroup@135daf(customers))
            TableSource@178aae1(orders - TableGroupJoin@16b904d(Join(user/customers/cid/user/user.orders/cid: user.orders -> user.customers, group(customers))))
      Project@a1d7b[orders.order_date, child.name]
        Select@158291[]
          Flatten@18f1a31(child)
            Select@c550[child.name != Smith]
              BranchLookup@9a18a0(parent -> parent)
                IndexScan@c6e1ec(Index(user.parent.name[IndexColumn(name)]), NONE, =customers.name)
                TableSource@16d3536(child - TableGroupJoin@11a5fd0(Join(user/parent/id/user/user.child/pid: user.child -> user.parent, group(parent))))
