SelectQuery@6ddaa877
  ResultSet@2e6a54f9[order_date, name]
    MapJoin@2f36d2ed()
      Flatten@3851ddd2(user.customers INNER user.orders)
        GroupScan@6ba22e1(Group(customers -> user._akiban_customers))
          TableSource@284f2189(user.customers - TableGroup@2647e53a(customers))
          TableSource@6322be0b(user.orders - TableGroupJoin@3a1a5678(Join(user/customers/cid/user/user.orders/cid: user.orders -> user.customers, group(customers))))
      Project@46f0bf3d[user.orders.order_date, user.child.name]
        Select@679b622d[]
          NullIfEmpty@1722fe15
            Select@7a572090[or(user.customers.name == user.parent.name,user.customers.name == upcase(user.parent.name))]
              Flatten@6e1b0caf(user.parent INNER user.child)
                GroupScan@31ddeda2(Group(parent -> user._akiban_parent))
                  TableSource@7deaf705(user.parent - TableGroup@611c4041(parent))
                  TableSource@4cffa9d8(user.child - TableGroupJoin@5be9d36(Join(user/parent/id/user/user.child/pid: user.child -> user.parent, group(parent))))